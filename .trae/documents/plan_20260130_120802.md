# 职责分离和代码规范化实现计划

## 1. 分析当前实现

- **apiService.ts**：目前只包含 `getGeojson` 函数和 `pathmap` 对象，功能简单
- **GeoDataService.ts**：包含完整的地理数据服务类，实现了数据加载、搜索和管理功能

## 2. 实现步骤

### 2.1 修改 apiService.ts 文件

- 扩展 API 服务功能，添加以下方法：
  - `getGeoDataMap()`: 获取地理数据映射表
  - `getGeoJSONData(path)`: 获取指定路径的 GeoJSON 数据
  - `generateGeoDataUrl(item)`: 生成地理数据的 URL
- 统一 API 请求的处理逻辑，确保错误处理的一致性
- 保持代码结构清晰，符合 TypeScript 最佳实践

### 2.2 修改 GeoDataService.ts 文件

- 移除直接的 API 请求方法，改为借用 apiService.ts 中的方法
- 保持地理数据的管理和业务逻辑处理功能
- 优化代码结构，减少重复代码
- 确保与 apiService.ts 的接口调用正确

### 2.3 验证功能完整性

- 确保所有 API 请求方法都已正确迁移到 apiService.ts
- 确保 GeoDataService 能够正确调用 apiService 中的方法
- 确保功能测试通过，没有引入新的错误
- 验证代码风格的一致性和可读性

## 3. 技术实现要点

- 使用 TypeScript 的模块化设计，分离 API 请求和业务逻辑
- 确保类型定义的一致性和准确性
- 实现统一的错误处理机制
- 保持代码结构清晰，易于维护和扩展
- 确保功能的完整性和正确性

## 4. 预期结果

- apiService.ts 包含所有 API 请求相关的方法
- GeoDataService.ts 专注于地理数据的管理和业务逻辑
- 代码量减少，职责分离明确
- 功能测试通过，没有引入新的错误
- 代码风格一致，符合 TypeScript 最佳实践
# 优化数据联动逻辑与图层同步

## 1. 精确控制开封市图层加载时机
- **调整触发逻辑**：修改 [DataSidebar.vue](file:///e:/github/EL2.0/frontend/src/components/DataAnalyse/DataSidebar.vue)，将自动检索并加载“开封市”图层的逻辑从通用的“确认添加”流程中移除。
- **模板专用触发**：仅在用户点击“加载模板数据”按钮（包括侧边栏引导和弹窗内按钮）时，才主动触发开封市矢量图层的检索与定位。
- **实现“数据找图层”**：普通数据添加完成后，系统将自动遍历当前地图上已有的图层，若名称匹配则立即应用数据驱动的样式。
- **实现“图层找数据”**：新图层加载后，系统会自动在已导入的数据状态中查找匹配项，确保图层一出现即带有正确的颜色分布。

## 2. 修复 GeoJSON 图层缩放同步问题
- **启用 Canvas 渲染**：在 [mapManager.ts](file:///e:/github/EL2.0/frontend/src/tools/mapManager.ts) 中初始化地图时，开启 `preferCanvas: true` 选项。
- **原理说明**：将矢量图层从 SVG 渲染切换为 Canvas 渲染，可以显著提升大量几何图形的渲染性能，并解决 Leaflet 在缩放动画过程中 SVG 容器与底图瓦片位移不完全同步的“掉队”现象。

## 3. 细节优化
- 确保 [TimeAxis.vue](file:///e:/github/EL2.0/frontend/src/components/DataAnalyse/TimeAxis.vue) 的点击跳转逻辑更加精准，滑块在缩放过程中保持稳定。

请确认以上计划，我将为您应用这些更改。
# MapManager方法复用优化方案

## 问题分析

当前的代码中存在两个功能相似的方法：

1. **MapManager.handleRegionSelected**：
   - 处理区域选择
   - 清除之前的区域图层
   - 加载GeoJSON数据
   - 创建并添加图层到地图
   - 调整地图视角

2. **SearchSection.handleAddGeoData**：
   - 处理地理数据添加
   - 检查是否已添加
   - 加载GeoJSON数据
   - 创建并添加图层到地图
   - 调整地图视角

用户希望复用MapManager的handleRegionSelected方法，添加一个参数来控制是单选还是多选模式：
- MapComponent：只选一个的情况
- MapContainer：可以多选的情况

## 优化方案

### 方案1：扩展MapManager.handleRegionSelected方法

1. **修改MapManager.ts**：

   * 在handleRegionSelected方法中添加一个参数控制单选/多选
   * 支持多选模式，允许添加多个区域
   * 保持单选模式的向后兼容性

2. **修改SearchSection.vue**：

   * 使用MapManager的handleRegionSelected方法替代自己的实现
   * 设置为多选模式

3. **修改MapComponent.vue**：

   * 确保使用单选模式

## 技术实现要点

1. **方法扩展**：
   - 在handleRegionSelected方法中添加一个`multiple`参数
   - 当multiple为true时，不清除之前的区域图层
   - 当multiple为false时，清除之前的区域图层（保持原有行为）

2. **代码复用**：
   - 让SearchSection组件使用MapManager的方法
   - 减少代码重复

3. **功能保持**：
   - 确保所有地图操作功能正常工作
   - 保持单选和多选模式的正确行为

## 预期效果

- 代码更加简洁，减少了重复逻辑
- 统一了区域选择和地理数据添加的处理方式
- 支持单选和多选模式
- 提高了代码的可维护性

## 实现步骤

1. 修改MapManager.ts，扩展handleRegionSelected方法
2. 修改SearchSection.vue，使用MapManager的handleRegionSelected方法
3. 确保MapComponent.vue使用正确的模式
4. 运行诊断工具，确保代码没有错误
5. 测试功能是否正常工作
